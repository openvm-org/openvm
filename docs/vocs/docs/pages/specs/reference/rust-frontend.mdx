# OpenVM Rust Frontend

OpenVM supports a Rust frontend via compilation to a 32-bit RISC-V target which is
then transpiled into an OpenVM executable with instructions from the RV32IM VM extension.
We implement this by **cross-compiling** for a platform which differs from the machine
performing the build. This involves the following:

- **Host**: The target and compiler toolchain used to run the program build and proving binaries. 
- **Guest**: The target and compiler toolchain used to build the program to be proven.

We detail the host and guest target and toolchain as well as the guest runtime for the 
OpenVM Rust frontend below.

## Host and Guest Target and Toolchain

The OpenVM Rust frontend supports the following host and guest target and toolchains:

- **Host**: We support `aarch64-apple-darwin` and `x86_64-unknown-linux-gnu` with Rust 1.86.0: `rustc 1.86.0 (05f9846f8 2025-03-31)`.
For reproducible builds, we recommend using the `x86_64-unknown-linux-gnu` platform.
- **Guest**: `riscv32im-risc0-zkvm-elf` with Rust `nightly-2025-02-14`: `rustc 1.86.0-nightly (a567209da 2025-02-13)`.

The `riscv32im-risc0-zkvm-elf` guest target incorporates special support for
zkVMs and has official support by the 
[Rust toolchain](https://doc.rust-lang.org/rustc/platform-support/riscv32im-risc0-zkvm-elf.html).
We anticipate upstreaming an OpenVM-specific target to Rust in the future.

:::info
We use a nightly Rust toolchain for the guest target in order to support compiling
`std` crates in a way compatible with zkVM usage.
:::

## Guest Runtime

The OpenVM Rust runtime supports `no_std` Rust by default, with optional `std` support available
through the `std` feature.  This section documents the different features of the runtime.

### Memory Allocator

OpenVM supports 512MB of guest memory, with stack growing down from `STACK_TOP = 0x0020_0400`,
program loading starting at `TEXT_START = 0x0020_0000`, and heap starting right afterwards.
We support two allocators:

- A **bump** allocator which increments a heap pointer for each successive allocation without
deallocating. This is the default allocator.
- A **linked-list** allocator from the `embedded-alloc` crate which supports deallocation 
at the cost of additional allocation overhead.

The linked-list allocator can be selected by enabling the `heap-embedded-alloc` feature on the 
`openvm-platform` crate.

### System Calls

### OpenVM Intrinsics

### OpenVM Kernels

### `std` Support